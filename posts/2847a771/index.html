<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>2.Spring Boot配置 | 哆啦C梦</title><meta name="description" content="2.Spring Boot配置"><meta name="keywords" content="教程,Spring Boot"><meta name="author" content="dora_cmon"><meta name="copyright" content="dora_cmon"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="c4z6ZbMZ8I"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="2.Spring Boot配置"><meta name="twitter:description" content="2.Spring Boot配置"><meta name="twitter:image" content="http://yoursite.com/images/cover/springboot.jpg"><meta property="og:type" content="article"><meta property="og:title" content="2.Spring Boot配置"><meta property="og:url" content="http://yoursite.com/posts/2847a771/"><meta property="og:site_name" content="哆啦C梦"><meta property="og:description" content="2.Spring Boot配置"><meta property="og:image" content="http://yoursite.com/images/cover/springboot.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://yoursite.com/posts/2847a771/"><link rel="prev" title="斐讯N1盒子开箱、降级、刷YYF固件全记录(转载)" href="http://yoursite.com/posts/7407c973/"><link rel="next" title="1.Spring Boot入门" href="http://yoursite.com/posts/15c32265/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: dora_cmon","link":"链接: http://yoursite.com/posts/2847a771/","source":"来源: 哆啦C梦","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">哆啦C梦</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">30</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">43</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#配置文件"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> 配置文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#yamlyaml-aint-markup-language"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> YAML(YAML Ain’t Markup Language)</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#yaml-基本语法"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text"> YAML 基本语法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#yaml-配置文件值获取注入"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text"> YAML 配置文件值获取(注入)</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#configurationproperties-与-value的区别"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text"> @ConfigurationProperties 与 @Value的区别</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#configurationproperties-例子"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text"> @ConfigurationProperties 例子</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#value-例子"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text"> @Value 例子</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#propertysource-importresource-bean"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text"> @PropertySource, @ImportResource, @Bean</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#配置文件占位符"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text"> 配置文件占位符</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#随机数"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text"> 随机数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#占位符默认值"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text"> 占位符默认值</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#profile-多环境支持"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text"> Profile 多环境支持</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#多-profile-文件形式"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text"> 多 profile 文件形式：</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#yml支持多文档块模式"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text"> yml支持多文档块模式：</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#激活方式"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text"> 激活方式:</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#配置文件加载位置"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text"> 配置文件加载位置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#外部配置加载顺序"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text"> 外部配置加载顺序</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#自动配置原理"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text"> 自动配置原理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#使用精髓"><span class="toc_mobile_items-number">9.1.</span> <span class="toc_mobile_items-text"> 使用精髓</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#自动配置类必须在一定的条件下才能生效"><span class="toc_mobile_items-number">9.2.</span> <span class="toc_mobile_items-text"> 自动配置类必须在一定的条件下才能生效</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#conditional-派生注解原生的-conditional-作用"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text"> @Conditional 派生注解（原生的 @Conditional 作用）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#更多"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text"> 更多</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#参考资料"><span class="toc_mobile_items-number">12.</span> <span class="toc_mobile_items-text"> 参考资料</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#配置文件"><span class="toc-number">1.</span> <span class="toc-text"> 配置文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yamlyaml-aint-markup-language"><span class="toc-number">2.</span> <span class="toc-text"> YAML(YAML Ain’t Markup Language)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml-基本语法"><span class="toc-number">2.1.</span> <span class="toc-text"> YAML 基本语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml-配置文件值获取注入"><span class="toc-number">2.2.</span> <span class="toc-text"> YAML 配置文件值获取(注入)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#configurationproperties-与-value的区别"><span class="toc-number">3.</span> <span class="toc-text"> @ConfigurationProperties 与 @Value的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#configurationproperties-例子"><span class="toc-number">3.1.</span> <span class="toc-text"> @ConfigurationProperties 例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#value-例子"><span class="toc-number">3.2.</span> <span class="toc-text"> @Value 例子</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#propertysource-importresource-bean"><span class="toc-number">4.</span> <span class="toc-text"> @PropertySource, @ImportResource, @Bean</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#配置文件占位符"><span class="toc-number">5.</span> <span class="toc-text"> 配置文件占位符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#随机数"><span class="toc-number">5.1.</span> <span class="toc-text"> 随机数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#占位符默认值"><span class="toc-number">5.2.</span> <span class="toc-text"> 占位符默认值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#profile-多环境支持"><span class="toc-number">6.</span> <span class="toc-text"> Profile 多环境支持</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#多-profile-文件形式"><span class="toc-number">6.1.</span> <span class="toc-text"> 多 profile 文件形式：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yml支持多文档块模式"><span class="toc-number">6.2.</span> <span class="toc-text"> yml支持多文档块模式：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#激活方式"><span class="toc-number">6.3.</span> <span class="toc-text"> 激活方式:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#配置文件加载位置"><span class="toc-number">7.</span> <span class="toc-text"> 配置文件加载位置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#外部配置加载顺序"><span class="toc-number">8.</span> <span class="toc-text"> 外部配置加载顺序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#自动配置原理"><span class="toc-number">9.</span> <span class="toc-text"> 自动配置原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用精髓"><span class="toc-number">9.1.</span> <span class="toc-text"> 使用精髓</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自动配置类必须在一定的条件下才能生效"><span class="toc-number">9.2.</span> <span class="toc-text"> 自动配置类必须在一定的条件下才能生效</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#conditional-派生注解原生的-conditional-作用"><span class="toc-number">10.</span> <span class="toc-text"> @Conditional 派生注解（原生的 @Conditional 作用）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#更多"><span class="toc-number">11.</span> <span class="toc-text"> 更多</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料"><span class="toc-number">12.</span> <span class="toc-text"> 参考资料</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/images/cover/springboot.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">2.Spring Boot配置</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-02-29<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-02-29</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0-Spring-Boot/">教程笔记 - Spring Boot</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="配置文件"><a class="markdownIt-Anchor" href="#配置文件"></a> 配置文件</h1>
<p>Spring Boot 使用一个全局配置文件，配置文件位置在 <code>src/main/resources</code> 目录下或 <code>类路径/config</code>下，文件名固定：</p>
<ul>
<li>application.properties</li>
<li>application.yml</li>
</ul>
<p>配置文件可以修改 Spring Boot 的默认配置。</p>
<h1 id="yamlyaml-aint-markup-language"><a class="markdownIt-Anchor" href="#yamlyaml-aint-markup-language"></a> YAML(YAML Ain’t Markup Language)</h1>
<p>以数据为中心，比 <code>json, xml</code> 等更适合做配置文件：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8081</span><br></pre></td></tr></table></figure></div>
<h2 id="yaml-基本语法"><a class="markdownIt-Anchor" href="#yaml-基本语法"></a> YAML 基本语法</h2>
<p><code>k:(空格)v</code> 表示一对键值对（空格必须有），以缩进来控制层级关系。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">/hello</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>
<p>字面量：普通值（数字，字符串，布尔）</p>
<p><code>k: v</code>：字符串默认不加引号；<code>&quot;&quot;</code> 双引号，不转义特殊字符；<code>''</code> 单引号，转义特殊字符</p>
</li>
<li>
<p>对象、Map（属性和值/键值对）</p>
<p>在对象下另起一行写属性和值，注意缩进：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">friends:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">Li</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">23</span></span><br></pre></td></tr></table></figure></div>
<p>行内写法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">friends:</span> <span class="string">&#123;lastName:</span> <span class="string">Li,</span> <span class="attr">age:</span> <span class="number">23</span><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>数组（List, Set）:</p>
<p>用 <code>-</code> 表示数组中的一个元素：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pets:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cat</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">dog</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">pig</span></span><br></pre></td></tr></table></figure></div>
<p>行内写法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pets:</span> <span class="string">[cat,</span> <span class="string">dog,</span> <span class="string">pig]</span></span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<h2 id="yaml-配置文件值获取注入"><a class="markdownIt-Anchor" href="#yaml-配置文件值获取注入"></a> YAML 配置文件值获取(注入)</h2>
<p>配置文件：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">hello</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">18</span></span><br><span class="line">  <span class="attr">boss:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">birth:</span> <span class="number">2017</span><span class="string">/12/12</span></span><br><span class="line">  <span class="attr">maps:</span> <span class="string">&#123;k1:</span> <span class="string">v1,</span> <span class="attr">k2:</span> <span class="string">v2&#125;</span></span><br><span class="line">  <span class="attr">lists:</span> <span class="string">[lisi,</span> <span class="string">zhaoliu]</span></span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">小狗</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">12</span></span><br></pre></td></tr></table></figure></div>
<p>javaBean：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将配置文件中配置的每一个属性的值，映射到这个组件中</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ConfigurationProperties</span>: 告诉 Spring Boot 将本类中的所有属性和配置文件中相关的配置进行绑定；</span></span><br><span class="line"><span class="comment"> *       prefix = "person"：配置文件中那个对象下的所有属性进行意义映射</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 只有这个组件是容器中的组件，才能提供容器的<span class="doctag">@ConfigurationProperties</span>功能；</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Configuration</span> Properties(prefix = <span class="string">"person"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String lastName;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> Boolean boss;</span><br><span class="line">  <span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> Map &amp;lt String, Object &amp;gt  maps;</span><br><span class="line">  <span class="keyword">private</span> List &amp;lt object &amp;gt  lists;</span><br><span class="line">  <span class="keyword">private</span> Dog dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>可以导入配置文件处理器，用来在编写配置文件时提供提示：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt !--导入配置文件处理器，配置文件进行绑定就会有提示-- &amp;gt</span><br><span class="line">&amp;lt dependency &amp;gt</span><br><span class="line">   &amp;lt groupId &amp;gt org.springframework.boot &amp;lt /groupId &amp;gt </span><br><span class="line">   &amp;lt artifactId &amp;gt spring-boot-configuration-processor &amp;lt /artifactId &amp;gt </span><br><span class="line">   &amp;lt optional &amp;gt true &amp;lt /optional &amp;gt </span><br><span class="line"> &amp;lt /dependency &amp;gt</span><br></pre></td></tr></table></figure></div>
<h1 id="configurationproperties-与-value的区别"><a class="markdownIt-Anchor" href="#configurationproperties-与-value的区别"></a> <code>@ConfigurationProperties</code> 与 <code>@Value</code>的区别</h1>
<table>
<thead>
<tr>
<th></th>
<th><code>@ConfigurationProperties</code></th>
<th><code>@Value</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>功能</td>
<td>批量注入配置文件中的属性</td>
<td>逐个指定</td>
</tr>
<tr>
<td>松散语法</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>JSR303数据校验</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>如果只在某个业务逻辑中需要获取一下配置文件中的某项值，则用 <code>@Value</code>；</p>
</li>
<li>
<p>如果专门编写了一个 javaBean 来和配置文件进行映射，则使用 <code>@ConfigurationProperties</code>;</p>
</li>
</ul>
<h2 id="configurationproperties-例子"><a class="markdownIt-Anchor" href="#configurationproperties-例子"></a> <code>@ConfigurationProperties</code> 例子</h2>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"person"</span>)</span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="comment">//lastName 必须是邮箱格式</span></span><br><span class="line">  <span class="meta">@Email</span></span><br><span class="line">  <span class="keyword">private</span> String lastName;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> Boolean boss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id="value-例子"><a class="markdownIt-Anchor" href="#value-例子"></a> <code>@Value</code> 例子</h2>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;person.last-name&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"#&#123;11*2&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"true"</span>)</span><br><span class="line">  <span class="keyword">private</span> Boolean boss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="propertysource-importresource-bean"><a class="markdownIt-Anchor" href="#propertysource-importresource-bean"></a> <code>@PropertySource, @ImportResource, @Bean</code></h1>
<ul>
<li>
<p><code>@PropertySource</code>：加载指定的配置文件；</p>
<p>而<code>@ConfigurationProperties()</code> 默认从全局配置文件中获取值，而 <code>@PropertySource</code> 可以从指定文件中获取值：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource</span>(value = &#123;<span class="string">"classpath:person.properties"</span>&#125;)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"person"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String lastName;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> Boolean boss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p><code>@ImportResource</code>：导入 Spring 的配置文件，让配置文件里的内容生效；</p>
<p>Spring Boot 里面没有 Spring 的配置文件，自己编写的配置文件也不能自动识别；想让 Spring 配置文件加载生效，需要将 <code>@ImportResource</code> 标注在一个配置类上。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 Spring 的配置文件让其生效</span></span><br><span class="line"><span class="meta">@ImportResource</span>(locations = &#123;<span class="string">"classpath:beans.xml"</span>&#125;)</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<p><strong>Spring Boot 推荐给容器中添加组件的方式</strong>：使用全注解的方式</p>
<ol>
<li>
<p>配置类 ———— Spring 配置文件</p>
</li>
<li>
<p>使用 <code>@Bean</code> 给容器中添加组件</p>
</li>
</ol>
  <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@Configuration</span>:指明当前类是一个配置类，替代 Spring 配置文件</span></span><br><span class="line"><span class="comment">  * 在配置文件中用 &amp;lt bean &amp;gt  &amp;lt /bean/ &amp;gt 标签添加组件</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppConfig</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 将方法的返回值添加到容器中；容器中这个组件默认的id就是方法名</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> HelloService <span class="title">helloService</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Systemout.println(<span class="string">"配置类@Bean给容器中添加组件..."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HelloService();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="配置文件占位符"><a class="markdownIt-Anchor" href="#配置文件占位符"></a> 配置文件占位符</h1>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.name = MyApp</span><br><span class="line">app.description = $&#123;app.name&#125; is a Spring Boot application</span><br></pre></td></tr></table></figure></div>
<h2 id="随机数"><a class="markdownIt-Anchor" href="#随机数"></a> 随机数</h2>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;random.value&#125;, $&#123;random.<span class="keyword">int</span>&#125;, $&#123;random.<span class="keyword">long</span>&#125;</span><br><span class="line">$&#123;random.<span class="keyword">int</span>(<span class="number">10</span>)&#125;, $&#123;random.<span class="keyword">int</span>[<span class="number">1024</span>, <span class="number">65535</span>]&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id="占位符默认值"><a class="markdownIt-Anchor" href="#占位符默认值"></a> 占位符默认值</h2>
<p>占位符可以在配置文件中引用前面配置过的属性，如果找不到指定属性时，可以用 <code>${app.name:默认值}</code> 来指定其默认值。</p>
<h1 id="profile-多环境支持"><a class="markdownIt-Anchor" href="#profile-多环境支持"></a> Profile 多环境支持</h1>
<p>Profile 是 Spring 对不融环境提供不同配置功能的支持，可以通过激活、指定参数等方式快速切换环境</p>
<h2 id="多-profile-文件形式"><a class="markdownIt-Anchor" href="#多-profile-文件形式"></a> 多 profile 文件形式：</h2>
<p>格式：application-{profile.properties}:</p>
<ul>
<li>application-dev.properties</li>
<li>application-prod.properties</li>
</ul>
<p>默认使用 <code>application.properties</code> 文件</p>
<h2 id="yml支持多文档块模式"><a class="markdownIt-Anchor" href="#yml支持多文档块模式"></a> yml支持多文档块模式：</h2>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8083</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8084</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">prod</span></span><br></pre></td></tr></table></figure></div>
<h2 id="激活方式"><a class="markdownIt-Anchor" href="#激活方式"></a> 激活方式:</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>命令行</td>
<td>java -jar file.jar --spring.profiles.active=dev</td>
</tr>
<tr>
<td>配置文件中指定</td>
<td>springprofiles.active=dev</td>
</tr>
<tr>
<td>jvm参数</td>
<td>-Dspring.profiles.active=dev</td>
</tr>
</tbody>
</table>
<h1 id="配置文件加载位置"><a class="markdownIt-Anchor" href="#配置文件加载位置"></a> 配置文件加载位置</h1>
<p>Spring Boot 启动会扫描一下位置的 <code>application.properties</code> 或者 <code>application.yml</code> 文件作为 Spring boot 的默认配置文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- file:.&#x2F;config&#x2F;</span><br><span class="line">- file:.&#x2F;</span><br><span class="line">- classpath:&#x2F;config&#x2F;</span><br><span class="line">- classpath:&#x2F;</span><br></pre></td></tr></table></figure></div>
<p>以上顺序优先级从高到低，所有位置的文件都会被加载，高优先级配置内容覆盖低优先级配置内容，所有配置互补。（也可以通过配置 spring.config.location 来改变默认配置）</p>
<h1 id="外部配置加载顺序"><a class="markdownIt-Anchor" href="#外部配置加载顺序"></a> 外部配置加载顺序</h1>
<p>Spring Boot 也可以从以下位置加载配置；优先级从高到低，高优先级配置内容覆盖低优先级配置内容，所有配置互补。</p>
<p><strong>1. 命令行参数</strong><br>
<strong><code>java -jar file.jar --server.port=8087 --server.context-path=/abc</code></strong><br>
<strong>多个配置用空格分开：<code>--配置项=值</code></strong><br>
&amp;lt /br &amp;gt 2. 来自 <code>java:comp/env</code> 的 NDI属性<br>
3. Java 系统属性 <code>System.getProperties()</code><br>
4. 操作系统环境变量<br>
5. <code>RandomValuePropertySource</code> 配置的 <code>random.*</code> 属性值</p>
<p><strong>由 jar 包外向 jar 包内进行寻找；</strong><br>
<strong>优先加载带<code>profile</code>；</strong><br>
<strong>6. <code>jar</code> 包外部的 <code>application-{profile}.properties</code> 或 <code>application.yml</code> （带 <code>spring.profile</code>）配置文件</strong><br>
<strong>7. <code>jar</code> 包内部的 <code>application-{profile}.properties</code> 或 <code>application.yml</code> （带 <code>spring.profile</code>）配置文件</strong></p>
<p><strong>然后加载不带<code>Profile</code>；</strong><br>
<strong>8. <code>jar</code> 包外部的 <code>application.properties</code> 或 <code>application.yml</code> （不带 <code>spring.profile</code>）配置文件</strong><br>
<strong>9.  <code>jar</code> 包内部的 <code>application.properties</code> 或 <code>application.yml</code> （不带 <code>spring.profile</code>）配置文件</strong><br>
&amp;lt /br &amp;gt 10. <code>@Configuration</code> 注解类上的 <code>@PropertySource</code><br>
11. 通过 SpringApplication</p>
<h1 id="自动配置原理"><a class="markdownIt-Anchor" href="#自动配置原理"></a> 自动配置原理</h1>
<p>Spring Boot 启动的时候加载主配置类，开启了自动配置功能 <code>@EnableAutoConfiguration</code></p>
<p>以<strong>HttpEncodingAutoConfiguration</strong>(Http编码自动配置)为例解释自动配置原理:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>   <span class="comment">//表示这是一个配置类，以前编写的配置文件一样，也可以给容器中添加组件</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(HttpEncodingProperties<span class="class">.<span class="keyword">class</span>)  //启动指定类的<span class="title">ConfigurationProperties</span>功能；将配置文件中对应的值和<span class="title">HttpEncodingProperties</span>绑定起来；并把<span class="title">HttpEncodingProperties</span>加入到<span class="title">ioc</span>容器中</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnWebApplication</span> //<span class="title">Spring</span>底层@<span class="title">Conditional</span>注解（<span class="title">Spring</span>注解版），根据不同的条件，如果满足指定的条件，整个配置类里面的配置就会生效；    判断当前应用是否是<span class="title">web</span>应用，如果是，当前配置类生效</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnClass</span>(<span class="title">CharacterEncodingFilter</span>.<span class="title">class</span>)  //判断当前项目有没有这个类<span class="title">CharacterEncodingFilter</span>；<span class="title">SpringMVC</span>中进行乱码解决的过滤器；</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnProperty</span>(<span class="title">prefix</span> </span>= <span class="string">"spring.http.encoding"</span>, value = <span class="string">"enabled"</span>, matchIfMissing = <span class="keyword">true</span>)  <span class="comment">//判断配置文件中是否存在某个配置  spring.http.encoding.enabled；如果不存在，判断也是成立的</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//即使我们配置文件中不配置pring.http.encoding.enabled=true，也是默认生效的；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpEncodingAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//他已经和SpringBoot的配置文件映射了</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> HttpEncodingProperties properties;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//只有一个有参构造器的情况下，参数的值就会从容器中拿</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">HttpEncodingAutoConfiguration</span><span class="params">(HttpEncodingProperties properties)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.properties = properties;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span>   <span class="comment">//给容器中添加一个组件，这个组件的某些值需要从properties中获取</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span>(CharacterEncodingFilter<span class="class">.<span class="keyword">class</span>) //判断容器没有这个组件</span></span><br><span class="line"><span class="class">  <span class="title">public</span> <span class="title">CharacterEncodingFilter</span> <span class="title">characterEncodingFilter</span>() </span>&#123;</span><br><span class="line">    CharacterEncodingFilter filter = <span class="keyword">new</span> OrderedCharacterEncodingFilter();</span><br><span class="line">    filter.setEncoding(<span class="keyword">this</span>.properties.getCharset().name());</span><br><span class="line">    filter.setForceRequestEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.REQUEST));</span><br><span class="line">    filter.setForceResponseEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.RESPONSE));</span><br><span class="line">    <span class="keyword">return</span> filter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>所有在配置文件中能配置的属性都在 <code>xxxxProperties</code> 类中封装；配置文件能配置什么可以参照某个功能对应的该属性类：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.http.encoding"</span>)  <span class="comment">//从配置文件中获取指定的值和bean的属性进行绑定</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpEncodingProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_CHARSET = Charset.forName(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure></div>
<p>可以查看 <code>HttpEncodingAutoConfiguration</code></p>
<h2 id="使用精髓"><a class="markdownIt-Anchor" href="#使用精髓"></a> 使用精髓</h2>
<ol>
<li>
<p>SpringBoot启动会加载大量的自动配置类</p>
</li>
<li>
<p>确定我们需要的功能有没有SpringBoot默认写好的自动配置类</p>
</li>
<li>
<p>再确定这个自动配置类中到底配置了哪些组件；（只要我们要用的组件有，就不需要重新配置了）</p>
</li>
<li>
<p>给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们可以在配置文件中指定这些属性的值</p>
</li>
</ol>
<h2 id="自动配置类必须在一定的条件下才能生效"><a class="markdownIt-Anchor" href="#自动配置类必须在一定的条件下才能生效"></a> 自动配置类必须在一定的条件下才能生效</h2>
<p><strong>可以通过启用  debug=true属性；来让控制台打印自动配置报告</strong>，这样我们就可以很方便的知道哪些自动配置类生效；</p>
<h1 id="conditional-派生注解原生的-conditional-作用"><a class="markdownIt-Anchor" href="#conditional-派生注解原生的-conditional-作用"></a> <code>@Conditional</code> 派生注解（原生的 <code>@Conditional</code> 作用）</h1>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">=========================</span><br><span class="line">AUTO-CONFIGURATION REPORT</span><br><span class="line">=========================</span><br><span class="line"></span><br><span class="line">Positive matches: <span class="comment">//（自动配置类启用的）</span></span><br><span class="line">-----------------</span><br><span class="line">  DispatcherServletAutoConfiguration matched:</span><br><span class="line">    - <span class="meta">@ConditionalOnClass</span> found required <span class="class"><span class="keyword">class</span> '<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">servlet</span>.<span class="title">DispatcherServlet</span>'</span>; <span class="meta">@ConditionalOnMissingClass</span> <span class="function">did not find unwanted <span class="title">class</span> <span class="params">(OnClassCondition)</span></span></span><br><span class="line"><span class="function">    - @<span class="title">ConditionalOnWebApplication</span> <span class="params">(required)</span> found <span class="title">StandardServletEnvironment</span> <span class="params">(OnWebApplicationCondition)</span></span></span><br><span class="line"><span class="function">        </span></span><br><span class="line"><span class="function">Negative matches: <span class="comment">//（没有启动，没有匹配成功的自动配置类）</span></span></span><br><span class="line"><span class="function">-----------------</span></span><br><span class="line"><span class="function">  ActiveMQAutoConfiguration:</span></span><br><span class="line"><span class="function">    Did not match:</span></span><br><span class="line"><span class="function">      - @ConditionalOnClass did not find required classes 'javax.jms.ConnectionFactory', 'org.apache.activemq.ActiveMQConnectionFactory' <span class="params">(OnClassCondition)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">  AopAutoConfiguration:</span></span><br><span class="line"><span class="function">    Did not match:</span></span><br><span class="line"><span class="function">      - @ConditionalOnClass did not find required classes 'org.aspectj.lang.annotation.Aspect', 'org.aspectj.lang.reflect.Advice' <span class="params">(OnClassCondition)</span></span></span><br></pre></td></tr></table></figure></div>
<p>必须是 <code>@Conditional</code> 指定的条件成立，才给容器中添加组件，配置配里面的所有内容才生效；</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>@Conditional扩展注解</td>
<td>作用（判断是否满足当前指定条件）</td>
</tr>
<tr>
<td>@ConditionalOnJava</td>
<td>系统的java版本是否符合要求</td>
</tr>
<tr>
<td>@ConditionalOnBean</td>
<td>容器中存在指定Bean；</td>
</tr>
<tr>
<td>@ConditionalOnMissingBean</td>
<td>容器中不存在指定Bean；</td>
</tr>
<tr>
<td>@ConditionalOnExpression</td>
<td>满足SpEL表达式指定</td>
</tr>
<tr>
<td>@ConditionalOnClass</td>
<td>系统中有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnMissingClass</td>
<td>系统中没有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnSingleCandidate</td>
<td>容器中只有一个指定的Bean，或者这个Bean是首选Bean</td>
</tr>
<tr>
<td>@ConditionalOnProperty</td>
<td>系统中指定的属性是否有指定的值</td>
</tr>
<tr>
<td>@ConditionalOnResource</td>
<td>类路径下是否存在指定资源文件</td>
</tr>
<tr>
<td>@ConditionalOnWebApplication</td>
<td>当前是web环境</td>
</tr>
<tr>
<td>@ConditionalOnNotWebApplication</td>
<td>当前不是web环境</td>
</tr>
<tr>
<td>@ConditionalOnJndi</td>
<td>JNDI存在指定项</td>
</tr>
</tbody>
</table>
<h1 id="更多"><a class="markdownIt-Anchor" href="#更多"></a> 更多</h1>
<p>更多Spring Boot教程笔记见<a href="/categories/%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0-Spring-Boot/">教程笔记 - Spring Boot</a></p>
<h1 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h1>
<p><a href="https://www.bilibili.com/video/av20965295" target="_blank" rel="noopener">尚硅谷SpringBoot顶尖教程(springboot之idea版spring boot)</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">dora_cmon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/posts/2847a771/">http://yoursite.com/posts/2847a771/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">哆啦C梦</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">教程    </a><a class="post-meta__tags" href="/tags/Spring-Boot/">Spring Boot    </a></div><div class="post_share"><div class="social-share" data-image="/images/cover/springboot.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/7407c973/"><img class="prev_cover lazyload" data-src="/images/cover/电路板.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>斐讯N1盒子开箱、降级、刷YYF固件全记录(转载)</span></div></a></div><div class="next-post pull_right"><a href="/posts/15c32265/"><img class="next_cover lazyload" data-src="/images/cover/springboot.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>1.Spring Boot入门</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/15c32265/" title="1.Spring Boot入门"><img class="relatedPosts_cover lazyload"data-src="/images/cover/springboot.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-27</div><div class="relatedPosts_title">1.Spring Boot入门</div></div></a></div><div class="relatedPosts_item"><a href="/posts/49760de/" title="VS Code配置Spring Boot"><img class="relatedPosts_cover lazyload"data-src="/images/cover/springboot.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-27</div><div class="relatedPosts_title">VS Code配置Spring Boot</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By dora_cmon</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-sun-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>